const t=new class{constructor(t){this.startX=null,this.startY=null,this.endX=null,this.endY=null,this.initializeBoard(),this.addKeyboardListeners(),this.handleSwipe();let e=document.querySelector(".game-field");e.addEventListener("touchstart",this.handleTouchStart.bind(this)),e.addEventListener("touchend",this.handleTouchEnd.bind(this))}handleTouchStart(t){this.startX=t.touches[0].clientX,this.startY=t.touches[0].clientY}handleTouchEnd(t){this.endX=t.changedTouches[0].clientX,this.endY=t.changedTouches[0].clientY,this.handleSwipe()}handleSwipe(){let t=this.endX-this.startX,e=this.endY-this.startY;Math.abs(t)>Math.abs(e)?t>0?this.moveRight():this.moveLeft():e>0?this.moveDown():this.moveUp(),this.boardMessage()}initializeBoard(){this.rows=4,this.columns=4,this.getState(),this.getScore()}findEmptyCells(){let t=[];for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)0===this.board[e][s]&&t.push({row:e,column:s});return t}createCell(){let t=this.findEmptyCells();if(t.length>0){let e=Math.floor(Math.random()*t.length),s=t[e],r=this.generateRandomNumber();this.board[s.row][s.column]=r,t.splice(t.indexOf(s),1)}}generateRandomNumber(){return .9>Math.random()?2:4}renderBoard(){let t=document.querySelector(".game-field tbody");t.innerHTML="";for(let e=0;e<this.rows;e++){let s=document.createElement("tr");for(let t=0;t<this.columns;t++){let r=document.createElement("td");r.classList.add("field-cell");let i=this.board[e][t];r.innerText=i||"",i&&(r.classList.add(`field-cell--${i}`),r.classList.add("field-cell--active")),r.class=e.toString()+"-"+t.toString(),s.appendChild(r)}t.appendChild(s)}}addKeyboardListeners(){document.addEventListener("keydown",t=>{"ArrowLeft"===t.key&&this.moveLeft(),"ArrowRight"===t.key&&this.moveRight(),"ArrowUp"===t.key&&this.moveUp(),"ArrowDown"===t.key&&this.moveDown(),this.boardMessage()})}filterZeroRow(t){return t.filter(t=>0!==t)}slideLeft(t){let e=this.filterZeroRow(t);for(let t=0;t<e.length;t++)e[t]===e[t+1]&&(e[t]*=2,e[t+1]=0,this.score+=e[t]);for(e=this.filterZeroRow(e);e.length<this.columns;)e.push(0);return e}moveLeft(){let t=this.board.map(t=>[...t]);for(let t=0;t<this.rows;t++){let e=this.board[t];e=this.slideLeft(e),this.board[t]=e}this.areArraysEqual(t,this.board)||this.isWinner()||this.createCell(),this.renderBoard(),this.updateScore()}areArraysEqual(t,e){if(t.length!==e.length)return!1;for(let s=0;s<t.length;s++)if(!t[s].every((t,r)=>t===e[s][r]))return!1;return!0}slideRight(t){let e=this.filterZeroRow(t);for(let t=e.length-1;t>0;t--)e[t]===e[t-1]&&(e[t]*=2,e[t-1]=0,this.score+=e[t]);for(e=this.filterZeroRow(e);e.length<this.columns;)e.unshift(0);return e}moveRight(){let t=this.board.map(t=>[...t]);for(let t=0;t<this.rows;t++){let e=this.board[t];e=this.slideRight(e),this.board[t]=e}this.areArraysEqual(t,this.board)||this.isWinner()||this.createCell(),this.renderBoard(),this.updateScore()}filterZeroColunms(t){return t&&t.length?t.filter(t=>0!==t):[]}slideUp(t){let e=this.filterZeroColunms(t);for(let t=0;t<e.length;t++)e[t]===e[t+1]&&(e[t]*=2,e[t+1]=0,this.score+=e[t]);for(e=this.filterZeroColunms(e);e.length<this.rows;)e.push(0);return e}transpose(t){return t[0].map((e,s)=>t.map(t=>t[s]))}moveUp(){let t=this.board.map(t=>[...t]),e=this.transpose(this.board);for(let t=0;t<this.rows;t++){let s=e[t];s=this.slideUp(s),e[t]=s}this.board=this.transpose(e),this.areArraysEqual(t,this.board)||this.isWinner()||this.createCell(),this.renderBoard(),this.updateScore()}slideDown(t){let e=this.filterZeroColunms(t);for(let t=e.length-1;t>0;t--)e[t]===e[t-1]&&(e[t]*=2,e[t-1]=0,this.score+=e[t]);for(e=this.filterZeroColunms(e);e.length<this.rows;)e.unshift(0);return e}moveDown(){let t=this.board.map(t=>[...t]),e=this.transpose(this.board);for(let t=0;t<this.rows;t++){let s=e[t];s=this.slideDown(s),e[t]=s}this.board=this.transpose(e),this.areArraysEqual(t,this.board)||this.isWinner()||this.createCell(),this.renderBoard(),this.updateScore()}updateScore(){document.querySelector(".game-score").innerText=this.score}getScore(){return this.score=0}getState(){return this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.board}getStatus(){let t=this.isGameOver(),e=this.isWinner();return this.isBoardEmpty()?"idle":t&&e?"win":t?"lose":"playing"}boardMessage(){let t=document.querySelector(".message-start"),e=document.querySelector(".message-lose"),s=document.querySelector(".message-win");this.isGameOver()&&(e.classList.remove("hidden"),t.classList.add("hidden")),this.isWinner()&&(t.classList.add("hidden"),s.classList.remove("hidden"))}isWinner(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)if(2048===this.board[t][e])return!0;return!1}isGameOver(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)if(0===this.board[t][e]||t!==this.rows-1&&this.board[t][e]===this.board[t+1][e]||e!==this.columns-1&&this.board[t][e]===this.board[t][e+1])return!1;return!0}start(){this.isBoardEmpty()&&(this.createCell(),this.createCell(),this.renderBoard())}isBoardEmpty(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)if(0!==this.board[t][e])return!1;return!0}restart(){let t=document.querySelector(".message-start"),e=document.querySelector(".message-lose"),s=document.querySelector(".message-win");this.isBoardEmpty()||(e.classList.add("hidden"),t.classList.remove("hidden"),s.classList.add("hidden"),this.initializeBoard(),this.updateScore(),this.renderBoard())}},e=document.querySelector(".start"),s=document.querySelector(".message-start");e.addEventListener("click",()=>{"idle"===t.getStatus()?(t.start(),e.textContent="Restart",e.classList.remove("start"),e.classList.add("restart"),s.classList.add("hidden")):(t.restart(),e.classList.remove("restart"),e.classList.add("start"),e.textContent="Start")});
//# sourceMappingURL=index.b491c6c7.js.map
